<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>04 - PrzeksztaÅ‚cenia geometryczne</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="_static/github-markdown.css" />
  <link rel="stylesheet" href="_static/custom.css" />
  <link rel="icon" type="image/x-icon" href="_static/favicon.ico" />
  <script>
  MathJax = {
      tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
      fontCache: 'global'
      }
  };
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<main class="markdown-body">
<header id="title-block-header">
<h1 class="title">04 - PrzeksztaÅ‚cenia geometryczne</h1>
</header>
<h1 id="wprowadzenie-do-przetwarzania-obrazÃ³w">Wprowadzenie do przetwarzania obrazÃ³w</h1>
<h2 id="politechnika-poznaÅ„ska-instytut-robotyki-i-inteligencji-maszynowej">Politechnika PoznaÅ„ska, Instytut Robotyki i Inteligencji Maszynowej</h2>
<p align="center">
  <img width="180" height="180" src="_static/logo.svg">
</p>

<h2 id="Ä‡wiczenie-laboratoryjne-4-przeksztaÅ‚cenia-geometryczne"><strong>Ä†wiczenie laboratoryjne 4: PrzeksztaÅ‚cenia geometryczne</strong></h2>
<p><a href="/lab-wdpo">PowrÃ³t do spisu treÅ›ci Ä‡wiczeÅ„ laboratoryjnych</a></p>
<h2 id="obsÅ‚uga-myszy-i-rysowanie-figur-na-obrazie">ObsÅ‚uga myszy i rysowanie figur na obrazie</h2>
<p>W celu obsÅ‚ugi myszy niezbÄ™dne jest â€œpodpiÄ™cieâ€ funkcji jej obsÅ‚ugi (tzw. callbacku) do odpowiedniego okna. Jest to realizowane za pomocÄ… funkcji <code>setMouseCallback</code> (<a href="https://docs.opencv.org/5.x/d7/dfc/group__highgui.html#ga89e7806b0a616f6f1d502bd8c183ad3e">dokumentacja</a>). Wymagany format tej funkcji wyglÄ…da nastÄ™pujÄ…co: <code>MouseCallback(event, x, y, flags,  userdata)</code>. Zdarzenia oraz flagi zwiÄ…zane z obsÅ‚ugÄ… myszki znajdziesz w <a href="https://docs.opencv.org/5.x/d0/d90/group__highgui__window__flags.html">https://docs.opencv.org/5.x/d0/d90/group__highgui__window__flags.html</a>.</p>
<p>W momencie wystÄ…pienia zdarzenia (tj. naciÅ›niÄ™cia jednego z przyciskÃ³w myszy, lub klawisza CTRL, SHIFT lub ALT) wywoÅ‚ana bÄ™dzie podpiÄ™ta funkcja, ktÃ³rej argumenty zostanÄ… przez system automatycznie uzupeÅ‚nione (tj. przekazana bÄ™dzie aktualna poÅ‚oÅ¼enie kursora na obrazie, a wszystkie flagi przyjmÄ… odpowiednie wartoÅ›ci). WÅ‚asne dane do funkcji obsÅ‚ugi zdarzenia moÅ¼na przekazaÄ‡ jako argument userdata.</p>
<p><span class="emoji" data-emoji="boom">ğŸ’¥</span> <strong>Zadanie do wykonania</strong> <span class="emoji" data-emoji="boom">ğŸ’¥</span></p>
<p>Napisz program rysujÄ…cy kwadrat po naciÅ›niÄ™ciu lewego klawisza myszy oraz okrÄ…g po naciÅ›niÄ™ciu prawego. Wykorzystaj do tego celu funkcjÄ™ <code>cv2.circle</code> oraz <code>cv2.rectangle</code> (<a href="https://docs.opencv.org/5.x/d6/d6e/group__imgproc__draw.html">dokumentacja</a>), wykorzystujÄ…c do tego celu wspÃ³Å‚rzÄ™dne kursora myszy i przykÅ‚adowy kod dostÄ™pny w <a href="https://docs.opencv.org/5.x/db/d5b/tutorial_py_mouse_handling.html">https://docs.opencv.org/5.x/db/d5b/tutorial_py_mouse_handling.html</a>.</p>
<blockquote>
<p><strong>Uwaga:</strong><br />
W systemie Ubuntu pod prawym przyciskiem myszy kryje siÄ™ menu kontekstowe. Z tego powodu naleÅ¼y kliknÄ…Ä‡ prawy przycisk dwukrotnie lub wykorzystaÄ‡ Å›rodkowy przycisk myszy.</p>
</blockquote>
<h2 id="transformacje-geometryczne">Transformacje geometryczne</h2>
<p>OprÃ³cz poznanej na ostatnich zajÄ™ciach operacji skalowania w OpenCV dostÄ™pne sÄ… rÃ³wnieÅ¼ inne transformacje geometryczne takie jak translacja (przesuniÄ™cie), czy rotacja (obrÃ³t).</p>
<ul>
<li><p><strong>Translacja</strong></p>
<p>Translacja o wektor $t_x$, $t_y$ jest realizowana przeksztaÅ‚ceniem: $$ R=\begin{bmatrix} 0 &amp; 0 &amp; t_{x} \\ 0 &amp; 0 &amp; t_{y} \\ 0 &amp; 0 &amp; 1 \end{bmatrix} $$</p></li>
<li><p><strong>Rotacja</strong></p>
<p>Rotacja o kÄ…t jest realizowana za pomocÄ… macierzy: $$ R=\begin{bmatrix} cos(\theta) &amp; -sin(\theta) &amp; 0 \\ sin(\theta) &amp; cos(\theta) &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{bmatrix} $$</p></li>
</ul>
<p>Oba te przeksztaÅ‚cenia oraz skalowanie sÄ… szczegÃ³lnymi przypadkami (elementami) transformacji afinicznej. Jej cechÄ… jest zachowanie rÃ³wnolegÅ‚oÅ›ci - linie rÃ³wnolegÅ‚e pozostajÄ… rÃ³wnolegÅ‚e rÃ³wnieÅ¼ po zastosowaniu przeksztaÅ‚cenia.</p>
<ul>
<li><p><strong>Transformacje afiniczne</strong></p>
<p>Transformacja afiniczna przeksztaÅ‚ca wspÃ³Å‚rzÄ™dne poszczegÃ³lnych pikseli obrazu we wspÃ³Å‚rzÄ™dne innego, liniowo zaleÅ¼nego ukÅ‚adu wspÃ³Å‚rzÄ™dnych. Transformacja zachowuje rÃ³wnolegÅ‚oÅ›Ä‡ prostych, tj. punkty, ktÃ³re leÅ¼aÅ‚y na jednej prostej po przeksztaÅ‚ceniu nadal leÅ¼Ä… na jednej prostej, a dodatkowo zachowany jest stosunek odlegÅ‚oÅ›ci (Å›rodek odcinka pozostaje Å›rodkiem danego odcinka po przeksztaÅ‚ceniu).</p>
<p>Transformacje afiniczne realizowane sÄ… przez przemnoÅ¼enie dotychczasowych wspÃ³Å‚rzÄ™dnych (przedstawionych jako wspÃ³Å‚rzÄ™dne jednorodne) przez macierz przeksztaÅ‚cenia R o wymiarach 3x3: $$ \begin{bmatrix}x'\\ y'\\ 1\end{bmatrix}=R\begin{bmatrix} x\\ y\\ 1\end{bmatrix} $$</p></li>
<li><p><strong>Transformacje perspektywiczna</strong></p>
<p>Transformacja perspektywiczna przeksztaÅ‚ca dowolny czworokÄ…t w jednej pÅ‚aszczyÅºnie na czworokÄ…t okreÅ›lony w innej pÅ‚aszczyÅºnie. Transformacja ta zachowuje linie proste, lecz moÅ¼e zmieniaÄ‡ kÄ…ty miÄ™dzy nimi. Efekty przeksztaÅ‚ceÅ„ moÅ¼na zaobserwowaÄ‡ w podanych <a href="https://docs.opencv.org/5.x/da/d6e/tutorial_py_geometric_transformations.html">przykÅ‚adach</a>. Transformacja realizowana jest za pomocÄ… mnoÅ¼enia przez macierz R o wymiarach 3x3:</p>
<p>$$ \begin{bmatrix} \omega{x}'\\ \omega{y}'\\ \omega \end{bmatrix}=R\begin{bmatrix} x\\ y\\ 1 \end{bmatrix} $$</p>
<p>gdzie macierz przeksztaÅ‚cenia przybiera postaÄ‡:</p>
<p>$$ R=\begin{bmatrix} a &amp; b &amp; c \\ d &amp; e &amp; f \\ g &amp; h &amp; 1 \end{bmatrix} $$</p>
<p>Macierz ta zawiera 8 niezaleÅ¼nych parametrÃ³w. Do ich okreÅ›lenia potrzebna jest znajomoÅ›Ä‡ wspÃ³Å‚rzÄ™dnych czterech odpowiadajÄ…cych sobie punktÃ³w.</p></li>
</ul>
<p><span class="emoji" data-emoji="boom">ğŸ’¥</span> <strong>Zadanie do wykonania</strong> <span class="emoji" data-emoji="boom">ğŸ’¥</span></p>
<ul>
<li><p>Pobierz udostÄ™pniony <a href="https://chmura.put.poznan.pl/s/SVpmItH96ZKxkhj">obraz</a>.</p></li>
<li><p>BazujÄ…c na kodzie dla przeksztaÅ‚cenia perspektywicznego oraz przykÅ‚adzie obsÅ‚ugi myszki, napisz program, ktÃ³ry:</p>
<ul>
<li>wczytuje udostÄ™pniony obraz drogi,</li>
<li>umoÅ¼liwia wybÃ³r czterech punktÃ³w (w ramach testÃ³w proszÄ™ klikaÄ‡ w kolejne naroÅ¼niki jezdni),</li>
<li>wykonuje przeksztaÅ‚cenie perspektywiczne w celu â€œwyprostowaniaâ€ jej.</li>
</ul></li>
</ul>
<h2 id="histogramy">Histogramy</h2>
<p>Histogram obrazuje liczebnoÅ›Ä‡ poszczegÃ³lnych wartoÅ›ci jasnoÅ›ci pikseli na obrazie. W przypadku obrazu w skali szaroÅ›ci moÅ¼liwy jest podziaÅ‚ na maksimum 256 przedziaÅ‚Ã³w (kaÅ¼dy o szerokoÅ›ci 1) lub mniejszÄ… liczbÄ™, w ktÃ³rej kaÅ¼da grupuje pewien zbiÃ³r wartoÅ›ci (dla 4 przedziaÅ‚Ã³w bÄ™dÄ… to wartoÅ›ci 0 - 63, 64 - 127, 128 - 191, 192 - 255). PrzykÅ‚adowy histogram (pochodzi ze <a href="http://www.cambridgeincolour.com/tutorials/histograms1.htm">strony</a>):</p>
<p align="center">
  <img src="./_04 - PrzeksztaÅ‚cenia geometryczne_readme_files/histogram.png" />
</p>

<p><span class="emoji" data-emoji="boom">ğŸ’¥</span> <strong>Zadanie do wykonania</strong> <span class="emoji" data-emoji="boom">ğŸ’¥</span></p>
<p>Zapoznaj siÄ™ z histogramami w opencv <a href="https://docs.opencv.org/5.x/d1/db7/tutorial_py_histogram_begins.html">https://docs.opencv.org/5.x/d1/db7/tutorial_py_histogram_begins.html</a>, a nastÄ™pnie wykonaj kroki:</p>
<ul>
<li>WyÅ›wietl histogram dla swojego obrazu, zarÃ³wno w skali szaroÅ›ci, jak i dla obrazu kolorowego.</li>
</ul>
<blockquote>
<p><strong>Uwaga:</strong><br />
Do wyznaczania histogramu uÅ¼yÄ‡ funkcji OpenCV - <code>cv2.calcHist</code>, natomiast do wyÅ›wietlania bibliotekÄ™ matplotlib.</p>
</blockquote>
<ul>
<li>Wykonaj operacjÄ™ wyrÃ³wnania histogramu (do fragmentu CLAHE (Contrast Limited Adaptive Histogram Equalization)) opisanÄ… w: <a href="https://docs.opencv.org/5.x/d5/daf/tutorial_py_histogram_equalization.html">https://docs.opencv.org/5.x/d5/daf/tutorial_py_histogram_equalization.html</a>.</li>
</ul>
<h2 id="zadania-do-samodzielnej-realizacji">Zadania do samodzielnej realizacji</h2>
<p><span class="emoji" data-emoji="boom">ğŸ’¥</span> <strong>Zadanie do wykonania</strong> <span class="emoji" data-emoji="boom">ğŸ’¥</span></p>
<p>Napisz program, ktÃ³ry umoÅ¼liwia zaznaczenie dwÃ³ch punktÃ³w (bÄ™dzie to lewy gÃ³rny rÃ³g i prawy dolny pewnego obszaru) i wykonanie w tym fragmencie obrazu operacji progowania dla kanaÅ‚u G (zielonego).</p>
<p><span class="emoji" data-emoji="boom">ğŸ’¥</span> <strong>Zadanie do wykonania</strong> <span class="emoji" data-emoji="boom">ğŸ’¥</span></p>
<p>Napisaz program, ktÃ³ry po wskazaniu przez uÅ¼ytkownika czterech punktÃ³w na <a href="https://chmura.put.poznan.pl/s/TYJWRbzeSPjLSfW">obrazie docelowym</a> wklei w niego <a href="https://chmura.put.poznan.pl/s/geDYp1TwDbGudqY">drugi obraz</a> tak, aby wskazane punkty okreÅ›laÅ‚y jego naroÅ¼niki (celem jest zastÄ…pienie jednego z obrazÃ³w wiszÄ…cych w galerii sztuki obrazem mopsa).</p>
<blockquote>
<p><strong>Uwaga:</strong><br />
Zadanie moÅ¼e wymagaÄ‡ <a href="https://docs.opencv.org/5.x/d0/d86/tutorial_py_image_arithmetics.html">dodawania obrazÃ³w z maskÄ… (bitwise operation)</a>.</p>
</blockquote>
</main>
</body>
</html>
